---
layout: post
title: ngrok基本使用
description: 调试工具
categories: [tools]
tags:  debug tool 
---

###导语
>开发移动端web页面，的时候会遇到这种情况，手机连着wifi,电脑插着网线，要利用手机来访问调试环境页面，如果WiFi和网线不是同一网段，那就没办法访问。而移动端的web开发，真机调试是必不可少的一部分，chrome的模拟并不能100%模拟真机效果。这时候可以用 wifi共享精灵等热点共享工具，模拟一个热点，手机连接后，可以访问，但这样的访问仍然不是同一网段，只有PC通过WIFI连接Internet,然后共享热点后，PC端打开fiddler，设置一个代理，然后再手机设置WIFI的代理是fiddler,端口8888，这样来自手机的请求都会通过fiddler发出，相当于通过PC来访问其他网站了。  
>但这种访问还是依赖于WIFI，如果离开WIFI覆盖范围，就不能访问了。

###ngrok
ngrok是一个反向代理，我们机器上运行起这个服务后，它可以把本地的一个端口代理到公网。任何可以访问公网的设备度可以访问该服务。
  
####适用场景:  
>1. 上述场景
>2. 急需把本地开发调试的内容给在一定距离之外的人看 

####使用
 我们使用的是国内网友自架的ngrok服务器，当然，如果自己有资源，[也可以自己搭建属于自己的ngrok服务](http://tonybai.com/2015/03/14/selfhost-ngrok-service/)  

1. 环境准备
首先 http://www.tunnel.mobi/ 下载所需的ngrok软件。windows环境，下载解压后是一个ngrok.exe文件。然后呢，还需要一个配置文件，同样也提供了下载，下载后是一个ngork.cfg文件。  
2. 运行服务
 在当前服务运行cmd命令终端，输入命令  
 ngrok -config ngrok.cfg -subdomain leochia 80  
![]({{site.url}}img/content/5.jpg)  
(写个bat比较方便)  
用-config参数来指定配置文件，-subdomain指定访问的子域名称和本地的端口。需要注意的是，该子域名不能与别人重名，这是你的唯一标示，之后通过http://leochia.tunnel.mobi来访问。  
![]({{site.url}}img/content/7.jpg)  
3. 调试页面  
 ![]({{site.url}}img/content/6.jpg)  
 127.0.0.1:4040是本地ngrok调试控制台，可以查看http请求头和返回内容，可以不刷新页面通过replay按钮重新发出请求
4. 其他
  缺点是，域名受限，如果你的网站访问受域名影响，如，本地缓存，广告过滤，那么这么访问是不会生效的。实际使用中还是搭配fiddler来使用。
